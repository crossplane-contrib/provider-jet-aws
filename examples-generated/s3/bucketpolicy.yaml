apiVersion: s3.aws.jet.crossplane.io/v1alpha1
kind: BucketPolicy
metadata:
  name: example
spec:
  forProvider:
    bucket: ${aws_s3_bucket.b.id}
    policy: |-
      ${jsonencode({
          Version = "2012-10-17"
          Id      = "MYBUCKETPOLICY"
          Statement = [
            {
              Sid       = "IPAllow"
              Effect    = "Deny"
              Principal = "*"
              Action    = "s3:*"
              Resource = [
                aws_s3_bucket.b.arn,
                "${aws_s3_bucket.b.arn}/*",
              ]
              Condition = {
                IpAddress = {
                  "aws:SourceIp" = "8.8.8.8/32"
                }
              }
            },
          ]
        })}
  providerConfigRef:
    name: example
